wp.customize&&wp.customize.controlConstructor&&wp.customize.controlConstructor["kirki-background"]&&(wp.customize.controlConstructor["kirki-background"]=wp.customize.controlConstructor["kirki-background"].extend({initKirkiControl:function(){var n=this,e=n.setting._value,a=n.container.find(".kirki-color-control");_.isUndefined(e["background-image"])&&(n.setting._value={"background-attachment":"","background-color":"","background-image":"","background-position":"","background-repeat":"","background-size":""}),(_.isUndefined(e["background-image"])||""===e["background-image"])&&(n.container.find(".background-wrapper > .background-repeat").hide(),n.container.find(".background-wrapper > .background-position").hide(),n.container.find(".background-wrapper > .background-size").hide(),n.container.find(".background-wrapper > .background-attachment").hide()),_.isUndefined(n.params.choices)||a.wpColorPicker(n.params.choices),setTimeout(function(){clear=n.container.find(".wp-picker-clear"),clear.click(function(){n.saveValue("background-color","")})},200),a.wpColorPicker({change:function(){setTimeout(function(){n.saveValue("background-color",a.val())},100)}}),n.container.on("change",".background-repeat select",function(){n.saveValue("background-repeat",jQuery(this).val())}),n.container.on("change click",".background-size input",function(){n.saveValue("background-size",jQuery(this).val())}),n.container.on("change",".background-position select",function(){n.saveValue("background-position",jQuery(this).val())}),n.container.on("change click",".background-attachment input",function(){n.saveValue("background-attachment",jQuery(this).val())}),n.container.on("click",".background-image-upload-button",function(e){var a=wp.media({multiple:!1}).open().on("select",function(){var e,o,r,i=a.state().get("selection").first(),t=i.toJSON().sizes.full.url;_.isUndefined(i.toJSON().sizes.medium)?_.isUndefined(i.toJSON().sizes.thumbnail)||(t=i.toJSON().sizes.thumbnail.url):t=i.toJSON().sizes.medium.url,e=i.toJSON().sizes.full.url,i.toJSON().id,i.toJSON().width,i.toJSON().height,""!==e&&n.container.find(".background-wrapper > .background-repeat, .background-wrapper > .background-position, .background-wrapper > .background-size, .background-wrapper > .background-attachment").show(),n.saveValue("background-image",e),o=n.container.find(".placeholder, .thumbnail"),r=n.container.find(".background-image-upload-remove-button"),o.length&&o.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+t+'" alt="" />'),r.length&&r.show()});e.preventDefault()}),n.container.on("click",".background-image-upload-remove-button",function(e){var a,o;e.preventDefault(),n.saveValue("background-image",""),a=n.container.find(".placeholder, .thumbnail"),o=n.container.find(".background-image-upload-remove-button"),n.container.find(".background-wrapper > .background-repeat").hide(),n.container.find(".background-wrapper > .background-position").hide(),n.container.find(".background-wrapper > .background-size").hide(),n.container.find(".background-wrapper > .background-attachment").hide(),a.length&&a.removeClass().addClass("placeholder").html("No file selected"),o.length&&o.hide()})}}));