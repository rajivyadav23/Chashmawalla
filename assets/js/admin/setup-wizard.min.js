var MollaWizardAdmin=[];!function(e){"use strict";var t=0,l=0,o="import_start",i=MollaWizardAdmin={initialised:!1,mobile:!1,init:function(){this.initialised||(this.initialised=!0,i.demoFilterIsotope(),i.selectedDemo(),i.importDetailOptions(),i.molla_demo_import_setting(),i.molla_load_more_plugins())},demoFilterIsotope:function(){if(e("#theme-install-demos").length){var t=e("#theme-install-demos").isotope(),l=e(".demo-sort-filters");l.find(".sort-source li").click(function(o){o.preventDefault();var i=e(this),s=i.data("filter-by");return t.isotope({filter:"*"==s?s:"."+s}),l.find(".sort-source li").removeClass("active"),i.addClass("active"),!1}),l.find('.sort-source li[data-active="true"]').click()}},selectedDemo:function(){e(document).on("click",".molla-install-demos .theme .theme-wrapper",function(t){t.preventDefault(),e(this).closest(".theme").hasClass("open-classic")?e(this).closest(".molla-install-demos").find('.demo-sort-filters [data-filter-by="classic"] a').click():e(this).closest(".theme").hasClass("open-shop")?e(this).closest(".molla-install-demos").find('.demo-sort-filters [data-filter-by="shop"] a').click():e(this).closest(".theme").hasClass("open-blog")?e(this).closest(".molla-install-demos").find('.demo-sort-filters [data-filter-by="blog"] a').click():(e("#molla-install-options").show(),e(this).closest(".molla-install-demos").find(".molla-install-demo .theme-screenshot").css("background-image",e(this).find(".theme-screenshot").css("background-image")),e(this).closest(".molla-install-demos").find(".molla-install-demo .theme-name").html(e(this).find(".theme-name").text()),e(this).closest(".molla-install-demos").find(".molla-install-demo .live-site").attr("href",e(this).find(".theme-name").data("live-url")),e(this).closest(".molla-install-demos").find(".molla-install-demo .more-options").removeClass("opened"),e(this).closest(".molla-install-demos").find(".molla-install-demo .molla-install-options-section").hide(),e(this).closest(".molla-install-demos").find(".molla-install-demo .plugins-used").remove(),e("#molla-install-demo-type").val(e(this).find(".theme-name").attr("id")),e(this).find(".plugins-used").length?(e(this).find(".plugins-used").clone().insertAfter(e(this).closest(".molla-install-demos").find(".molla-install-section")),e(this).closest(".molla-install-demos").find(".molla-install-demo .molla-install-section").hide(),e(this).closest(".molla-install-demos").find(".molla-install-demo .more-options").hide()):(e(this).closest(".molla-install-demos").find(".molla-install-demo .molla-install-section").show(),e(this).closest(".molla-install-demos").find(".molla-install-demo .more-options").show()),e(".molla-import-yes:not(:disabled)").length&&e(".molla-install-demo #import-status").html(""),e.magnificPopup.open({items:{src:".molla-install-demo"},type:"inline",mainClass:"mfp-with-zoom",zoom:{enabled:!0,duration:300}}))})},alertLeavePage:function(e){var t="Are you sure you want to leave?";return e.returnValue=t,t},addAlertLeavePage:function(){e(".molla-import-yes.btn-primary").attr("disabled","disabled"),e(".mfp-bg, .mfp-wrap").unbind("click"),e(window).bind("beforeunload",i.alertLeavePage)},removeAlertLeavePage:function(){e(".molla-import-yes.btn-primary").removeAttr("disabled"),e(".mfp-bg, .mfp-wrap").bind("click",function(t){e(t.target).is(".mfp-wrap .mfp-content *")||(t.preventDefault(),e.magnificPopup.close())}),e(window).unbind("beforeunload",i.alertLeavePage)},importDetailOptions:function(){e(".molla-install-demo .more-options").click(function(t){t.preventDefault(),e(this).toggleClass("opened"),e(this).closest(".molla-install-demo").find(".molla-install-options-section").stop().toggle("slide")})},showImportMessage:function(t,l,o,i){var s="";if(t&&(s+='<h3 class="molla-demo-install"><i class="molla-ajax-loader"></i> Installing '+e("#"+t).html()+"</h3>"),l&&(s+="<strong>"+l+"</strong>"),o&&i){var a=i/o*100;a>100&&(a=100),s+='<div class="import-progress-bar"><div style="width:'+a+'%;"></div></div>'}e(".molla-install-demo #import-status").stop().show().html(s)},molla_demo_import_setting:function(){e(".molla-import-yes").click(function(){if(confirm("Are you sure to import demo contents and override old one?")){i.addAlertLeavePage();var t=e("#molla-install-demo-type").val(),l={demo:t,reset_menus:e("#molla-reset-menus").is(":checked"),reset_widgets:e("#molla-reset-widgets").is(":checked"),import_dummy:e("#molla-import-dummy").is(":checked"),import_widgets:e("#molla-import-widgets").is(":checked"),import_options:e("#molla-import-options").is(":checked"),override_contents:e("#molla-override-contents").is(":checked")};if(e(this).hasClass("alternative")?l.dummy_action="molla_import_dummy_step_by_step":l.dummy_action="molla_import_dummy",l.demo){i.showImportMessage(t,"");var o={action:"molla_download_demo_file",demo:t,wpnonce:molla_setup_wizard_params.wpnonce};e.post(ajaxurl,o,function(o){try{o=e.parseJSON(o)}catch(e){}o&&o.process&&"success"==o.process?i.molla_import_options(l):o&&o.process&&"error"==o.process?i.molla_import_failed(t,o.message):i.molla_import_failed(t)}).fail(function(e){i.molla_import_failed(t)})}e("#molla-install-options").slideUp()}})},molla_import_options:function(t){if(t.demo)if(t.import_options){var l=t.demo,o={action:"molla_import_options",demo:l,wpnonce:molla_setup_wizard_params.wpnonce};i.showImportMessage(l,"Importing theme options"),e.post(ajaxurl,o,function(e){e&&i.showImportMessage(l,e),i.molla_reset_menus(t)}).fail(function(e){i.molla_reset_menus(t)})}else i.molla_reset_menus(t);else i.removeAlertLeavePage()},molla_reset_menus:function(t){if(t.demo)if(t.reset_menus){var l=t.demo,o={action:"molla_reset_menus",import_shortcodes:t.import_shortcodes,wpnonce:molla_setup_wizard_params.wpnonce};e.post(ajaxurl,o,function(e){e&&i.showImportMessage(l,e),i.molla_reset_widgets(t)}).fail(function(e){i.molla_reset_widgets(t)})}else i.molla_reset_widgets(t);else i.removeAlertLeavePage()},molla_reset_widgets:function(t){if(t.demo)if(t.reset_widgets){var l=t.demo,o={action:"molla_reset_widgets",wpnonce:molla_setup_wizard_params.wpnonce};e.post(ajaxurl,o,function(e){e&&i.showImportMessage(l,e),i.molla_import_dummy(t)}).fail(function(e){i.molla_import_dummy(t)})}else i.molla_import_dummy(t);else i.removeAlertLeavePage()},molla_import_dummy:function(e){if(e.demo)if(e.import_dummy){var s=e.demo,a={action:e.dummy_action,process:"import_start",demo:s,override_contents:e.override_contents,wpnonce:molla_setup_wizard_params.wpnonce};t=0,l=0,o="import_start",i.molla_import_dummy_process(e,a),i.showImportMessage(s,"Importing posts")}else i.molla_import_widgets(e);else i.removeAlertLeavePage()},molla_import_dummy_process:function(s,a){var n=s.demo;e.post(ajaxurl,a,function(m){if(m&&/^[\],:{}\s]*$/.test(m.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))if("complete"!=(m=e.parseJSON(m)).process){var r={action:a.action,wpnonce:molla_setup_wizard_params.wpnonce};m.process&&(r.process=m.process),m.index&&(r.index=m.index),r.demo=n,r.override_contents=s.override_contents,i.molla_import_dummy_process(s,r),t=m.index,l=m.count,o=m.process,i.showImportMessage(n,m.message,l,t)}else i.showImportMessage(n,m.message),i.molla_import_widgets(s);else i.molla_import_failed(n)}).fail(function(e){if("molla_import_dummy"==a.action)i.molla_import_failed(n);else{var m;t<l?((m={action:a.action,wpnonce:molla_setup_wizard_params.wpnonce}).process=o,m.index=++t,m.demo=n,i.molla_import_dummy_process(s,m)):((m={action:a.action,wpnonce:molla_setup_wizard_params.wpnonce}).process=o,m.demo=n,i.molla_import_dummy_process(s,m))}})},molla_import_widgets:function(t){if(t.demo)if(t.import_widgets){var l=t.demo,o={action:"molla_import_widgets",demo:l,wpnonce:molla_setup_wizard_params.wpnonce};i.showImportMessage(l,"Importing widgets"),e.post(ajaxurl,o,function(e){e&&i.molla_import_finished(t)})}else i.molla_import_finished(t);else i.removeAlertLeavePage()},molla_delete_tmp_dir:function(t){var l={action:"molla_delete_tmp_dir",demo:t,wpnonce:molla_setup_wizard_params.wpnonce};e.post(ajaxurl,l,function(e){})},molla_import_failed:function(t,l){i.molla_delete_tmp_dir(t),void 0===l?i.showImportMessage(t,'Failed importing! Please check the <a href="'+window.location.href.replace("?page=molla-demos","?page=molla-system")+'" target="_blank">"System Status"</a> tab to ensure your server meets all requirements for a successful import. Settings that need attention will be listed in red. If your server provider does not allow to update settings, please try using alternative import mode.'):i.showImportMessage(t,l),i.removeAlertLeavePage(),e(".molla-install-demo .molla-demo-install .molla-ajax-loader").remove(),e(".molla-install-demo .molla-demo-install").html(e("#molla-install-options .theme-name").text()+" installation is failed!"),e(".molla-install-demo .molla-demo-install").css("padding-left",0),e("#molla-install-options").show()},molla_import_finished:function(t){if(t.demo){var l=t.demo;i.molla_delete_tmp_dir(l),setTimeout(function(){e("#wp-admin-bar-view-site").length?i.showImportMessage(l,'<a href="'+e("#wp-admin-bar-view-site a").attr("href")+'" target="_blank">Visit your site.</a>'):e("#current_site_url").length?i.showImportMessage(l,'<a href="'+e("#current_site_url").val()+'" target="_blank">Visit your site.</a>'):i.showImportMessage(l,""),e(".molla-install-demo .molla-demo-install .molla-ajax-loader").remove(),e(".molla-install-demo .molla-demo-install").html(e("#"+l).html()+" installation is finished!"),e(".molla-install-demo .molla-demo-install").css("padding-left",0),i.removeAlertLeavePage()},3e3)}else removeAlertLeavePage()},molla_load_more_plugins:function(){e("body").on("click",".button-load-plugins",function(t){t.preventDefault(),e(this).closest(".molla-setup-wizard-plugins").children(".hidden").hide(),e(this).closest(".molla-setup-wizard-plugins").children(".hidden").fadeIn(),e(this).closest(".molla-setup-wizard-plugins").children(".hidden").removeClass("hidden"),e(this).hide()})}};jQuery(document).ready(function(e){MollaWizardAdmin.init()})}(jQuery);var MollaWizard=function(e){function t(){e(".button-next").on("click",function(t){return!!function(t){function l(){if(!n){for(var e="",t=0;t<r.length;t++)r[t]=r[t]+1,r[t]>=a.length&&(r[t]=0),e+=a.charAt(r[t]);o[m](e),setTimeout(function(){l()},60)}}var o=e(t);if("yes"==o.data("done-loading"))return!1;var i=o.text(),s=o.outerWidth(),a="⡀⡀⡀⡀⡀⡀⡀⡀⡀⡀⠄⠂⠁⠁⠂⠄",n=!1;o.css("width",s),o.addClass("wizard_step_loading_button_current");var m=o.is("input")||o.is("button")?"val":"text";o[m](a),o.data("done-loading","yes");var r=[0,1,2];return l(),{done:function(){n=!0,o[m](i),o.removeClass("wizard_step_loading_button_current"),o.attr("disabled",!1)}}}(this)&&(e(this).data("callback")&&void 0!==i[e(this).data("callback")]?(i[e(this).data("callback")](this),!1):(l(),!0))}),e(".button-upload").on("click",function(t){t.preventDefault(),function(){"use strict";var t,l;if(void 0!==t)return void t.open();(t=wp.media.frames.file_frame=wp.media({title:"Upload Logo",button:{text:"Select Logo"},multiple:!1})).on("select",function(){l=t.state().get("selection").first().toJSON(),e(".site-logo").attr("src",l.url),e("#new_logo_id").val(l.id)}),t.open()}()}),e(".theme-presets a").on("click",function(t){t.preventDefault();e(this).parents("ul").first().find(".current").removeClass("current");e(this).parents("li").first().addClass("current");var l=e(this).data("style");return e("#new_style").val(l),!1}),e(".molla-unused-widgets .molla-page").on("click",function(t){var l=e(this).parent();l.hasClass("active")?(l.removeClass("active"),l.children("ul").slideUp(300)):(l.addClass("active"),l.children("ul").slideDown(300))}),e(".molla-unused-widgets .molla-page .checkbox-toggle").on("click",function(t){e(this).find(".toggle").hasClass("none")?(e(this).find(".toggle").removeClass("none").addClass("all"),e(this).closest(".molla-unused-widgets").find("ul input.widget").prop("checked",!0)):(e(this).find(".toggle").removeClass("all").addClass("none"),e(this).closest(".molla-unused-widgets").find("ul input.widget").prop("checked",!1)),t.stopImmediatePropagation()}),e(".molla-unused-widgets ul label.checkbox").on("click",function(t){var l=e(this).closest(".molla-unused-widgets").find("ul input.widget:checked").length;e(this).closest(".molla-unused-widgets").find("ul input.widget").length==l?e(this).closest(".molla-unused-widgets").find(".toggle").removeClass("none").addClass("all"):0==l?e(this).closest(".molla-unused-widgets").find(".toggle").removeClass("all").addClass("none"):e(this).closest(".molla-unused-widgets").find(".toggle").removeClass("all none")}),e(".molla_submit_form label input").on("click",function(t){e(".molla_submit_form .step").find('[name="'+e(this).attr("name")+'"]').attr("value",e(this).prop("checked"))})}function l(){e(".envato-setup-content").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})}function o(){function t(t){e(".molla-unused-widgets#"+t.id+" .molla-page").removeClass("installing"),e(".molla-unused-widgets#"+t.id+" .spinner").css("visibility",""),"object"==typeof t&&void 0!==t.message&&t.done?e(".molla-unused-widgets#"+t.id+" .result").text("Successfully optimized widgets").css("color","#6b8fd2"):(e(".molla-unused-widgets#"+t.id+" .result").text("Error occurs while optimizing css file").css("color","#ef5858"),i=!1),o()}function o(){var l=e(".molla-unused-widgets > .molla-page.installing").eq(0);l.length?function(l){var o=[];l.find("ul input.widget").each(function(){e(this).prop("checked")&&o.push(e(this).attr("name"))}),e.ajax({url:ajaxurl,data:{action:"molla_speed_wizard_remove_widgets",wpnonce:molla_setup_wizard_params.wpnonce,id:l.attr("id"),unused:o},type:"post",success:t}).fail(t)}(l.closest(".molla-unused-widgets")):i&&(e("body").trigger("unused_widgets_removed"),-1==location.href.indexOf("molla_demo_id")&&complete())}var i=!0;return{init:function(t){e(".molla-unused-widgets > ul").slideUp(300),e(".molla-unused-widgets > .molla-page").addClass("installing"),e(".molla-unused-widgets .spinner").css("visibility","visible"),complete=function(){l(),e(t).attr("href")&&"#"!=e(t).attr("href")?window.location.href=t.href:window.location.reload()},o()}}}var i={install_plugins:function(t){(new function(){function t(l){"object"==typeof l&&void 0!==l.message?(a.find("span").text(l.message),void 0!==l.url?l.hash==r?(a.find("span").text("failed"),i()):(r=l.hash,e.post(l.url,l,function(e){o(),a.find("span").text(l.message)}).fail(t)):(l.done,i())):(a.find("span").text("ajax error"),i())}function o(){m&&e.post(ajaxurl,{action:"undefined"==typeof molla_setup_wizard_params?"molla_speed_optimize_wizard_plugins":"molla_setup_wizard_plugins",wpnonce:"undefined"==typeof molla_setup_wizard_params?molla_speed_optimize_wizard_params.wpnonce:molla_setup_wizard_params.wpnonce,slug:m},t).fail(t)}function i(){var t=!1;a&&(a.data("done_item")||(n++,a.data("done_item",1)),a.find(".spinner").css("visibility","hidden")),e(".molla-setup-wizard-plugins li").each(function(){e(this).hasClass("installing")&&(""==m||t?(m=e(this).data("slug"),a=e(this),o(),t=!1):e(this).data("slug")==m&&(t=!0))}),n>=e(".molla-setup-wizard-plugins li.installing").length&&s()}var s,a,n=0,m="",r="";return{init:function(t){e(".molla-setup-wizard-plugins > li").each(function(){e(this).find('input[type="checkbox"]').is(":checked")&&e(this).addClass("installing")}),s=function(){l(),e(t).attr("href")&&"#"!=e(t).attr("href")?window.location.href=t.href:window.location.reload()},i()}}}).init(t)},remove_widgets:function(e){(new o).init(e)}};return{init:function(){e(t)}}}(jQuery);MollaWizard.init();