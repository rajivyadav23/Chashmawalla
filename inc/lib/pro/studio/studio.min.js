jQuery(document).ready(function(e){"use strict";var t=!1,o="all",a="";window.runStudio=function(o){e("#molla-elementor-panel-molla-studio").trigger("click"),o&&(t=e(o).closest(".elementor-add-section"))},elementor.on("panel:init",function(){e('<div id="molla-elementor-panel-molla-studio" class="elementor-panel-footer-tool tooltip-target" data-tooltip="Molla Studio"><img class="molla-studio-icon" src="https://d-themes.com/wordpress/molla/wp-content/themes/molla/assets/images/logo-studio-mini.png" alt="Molla Studio"><span class="elementor-screen-only">Molla Studio</span></div>').insertAfter("#elementor-panel-footer-saver-preview").tipsy({gravity:"s",title:function(){return this.getAttribute("data-tooltip")}})}),e(window).on("load",function(){if(e(".blocks-wrapper .blocks-list .block").length){var l=1;e(".blocks-wrapper .category-list a").on("click",function(t,o,a){if(t.preventDefault(),e(".blocks-wrapper").hasClass("loading"))return!1;l=void 0!==o?parseInt(o,10):1;var i=e(this),r={action:"molla_studio_filter_category",category_id:i.data("filter-by"),count_per_page:i.data("limit"),wpnonce:molla_studio.wpnonce,page:l};void 0!==a&&(r.demo_filter=a),e(document.body).hasClass("elementor-editor-active")?r.type="e":r.type="v",e(".blocks-wrapper").addClass("loading"),e.ajax({url:ajaxurl,type:"post",dataType:"html",data:r,success:function(t){if("error"!=t){1===l&&e(".blocks-wrapper .blocks-list").isotope("remove",e(".blocks-wrapper .blocks-list").children());var o=e(t).find(".blocks-list").children();if(e(".blocks-wrapper .blocks-list").append(o),e(".blocks-wrapper .blocks-list").isotope("appended",o),e(".blocks-wrapper .category-list a").removeClass("active"),i.addClass("active"),void 0!==a){var r=e(t).find(".category-list li:hidden a").data("total-page");r?i.data("total-page",parseInt(r,10)):i.data("total-page",1)}e(".blocks-wrapper .blocks-list").waitForImages(function(){e(".blocks-wrapper .blocks-list").isotope("layout"),e(".blocks-wrapper").removeClass("loading").removeClass("infiniteloading"),e(".mfp-wrap.blocks-cont").trigger("scroll")})}else e(".blocks-wrapper").removeClass("loading").removeClass("infiniteloading")}}).fail(function(t,o,a){alert("Loading failed!"),e(".blocks-wrapper").removeClass("loading").removeClass("infiniteloading")})}),e(".blocks-wrapper .blocks-list").on("click",".import",function(o){o.preventDefault();var a=e(this),l=a.data("id");a.attr("disabled","disabled"),a.closest(".block").addClass("importing");var i={action:"molla_studio_import",block_id:l,wpnonce:molla_studio.wpnonce};e(document.body).hasClass("elementor-editor-active")?i.type="e":i.type="v",e.ajax({url:ajaxurl,type:"post",dataType:"json",data:i,success:function(o){if(o&&o.content)if("undefined"!=typeof vc&&vc.storage)vc.storage.append(o.content),vc.shortcodes.fetch({reset:!0}),_.delay(function(){window.vc.undoRedoApi.unlock()},50);else if(window.vc_iframe_src){var i={action:"vc_frontend_load_template",block_id:l,content:o.content,wpnonce:molla_studio.wpnonce,template_unique_id:"1",template_type:"my_templates",vc_inline:!0,_vcnonce:window.vcAdminNonce};o.meta&&(i.meta=o.meta),e.ajax({url:window.vc_iframe_src.replace(/&amp;/g,"&"),type:"post",data:i,success:function(t){var o,a;_.each(e(t),function(e){if("vc_template-data"===e.id)try{a=JSON.parse(e.innerHTML)}catch(e){}"vc_template-html"===e.id&&(o=e.innerHTML)}),o&&a&&(vc.builder.buildFromTemplate(o,a),vc.closeActivePanel())}}).always(function(){a.removeAttr("disabled"),a.closest(".block").removeClass("importing")})}else if("undefined"!=typeof elementor){var r=function(e){Array.isArray(e)&&e.forEach(function(t,o){t.elements&&r(t.elements),t.elType&&(e[o].id=elementor.helpers.getUniqueID())})};Array.isArray(o.content)&&1==o.content.length&&("widget"==o.content[0].elType?o.content=[{elType:"section",elements:[{elType:"column",elements:o.content}]}]:"column"==o.content[0].elType&&(o.content=[{elType:"section",elements:o.content}])),r(o.content),elementor.getPreviewView().addChildModel(o.content,t&&t.parent().hasClass("elementor-section-wrap")?(t.find(".elementor-add-section-close").trigger("click"),{at:t.index()}):{}),elementor.saver&&elementor.saver.footerSaver&&elementor.saver.footerSaver.activateSaveButtons?elementor.saver.footerSaver.activateSaveButtons(document,"publish"):$e.run("document/save/publish")}if(o&&o.meta)for(var s in o.meta){var n=o.meta[s].replace("/<script.*?/script>/s","");if("undefined"!=typeof vc&&vc.storage&&e('[name="'+s+'"]').length)switch(e('[name="'+s+'"]')[0].tagName.toLowerCase()){case"input":var c=e('[name="'+s+'"]').attr("type").toLowerCase();"text"==c||"hidden"==c?e('[name="'+s+'"]').val(n):"checkbox"!=c&&"radio"!=c||(e('[name="'+s+'"]').removeProp("checked"),e('[name="'+s+'"]').each(function(){e(this).val()==n&&e(this).prop("checked","checked")}));break;case"select":e('[name="'+s+'"] option').removeProp("selected"),e('[name="'+s+'"] option[value="'+n+'"]').prop("selected","selected"),e('[name="'+s+'"]').val(n);break;default:e('[name="'+s+'"]').each(function(){e(this).val(e(this).val()+n)})}else if(window.vc_iframe_src)void 0===molla_studio.meta_fields&&(molla_studio.meta_fields={}),void 0===molla_studio.meta_fields[s]&&(molla_studio.meta_fields[s]=""),-1===molla_studio.meta_fields[s].indexOf(n)&&(molla_studio.meta_fields[s]+=n);else if("undefined"!=typeof elementor){var d=elementor.settings.page.model.get(s);void 0===d&&(d=""),d&&-1!==d.indexOf(n)||elementor.settings.page.model.set(s,d+n),"page_css"==s&&(elementorFrontend.hooks.doAction("refresh_dynamic_css",d+n,l),e('textarea[data-setting="page_css"]').val(d+n))}}o&&o.error&&alert(o.error)},failure:function(){alert("There was an error when importing block. Please try again later!")}}).always(function(){a.removeAttr("disabled"),a.closest(".block").removeClass("importing")})}),e("#vc_button-update").on("click",function(t){molla_studio.meta_fields&&vc_post_id&&e.ajax({url:ajaxurl,type:"post",dataType:"json",data:{action:"molla_studio_save",post_id:vc_post_id,nonce:molla_studio.wpnonce,fields:molla_studio.meta_fields}})}),e(".blocks-wrapper .demo-filter-trigger").on("click",function(t){t.preventDefault(),e(this).parent().toggleClass("active")}),e(".blocks-wrapper .demo-filter .filter1").on("change",function(t){"all"!=e(this).val()?(e(".blocks-wrapper .demo-filter .filter2 option").removeAttr("selected").hide(),e('.blocks-wrapper .demo-filter .filter2 option[data-filter*="'+e(this).val()+'"]').show(),e(".blocks-wrapper .demo-filter .filter2 option:first-child").attr("selected","selected").show()):e(".blocks-wrapper .demo-filter .filter2 option").removeAttr("selected").show(),o!=e(this).val()||a!=e(".blocks-wrapper .demo-filter .filter2").val()?e(".demo-filter .btn").removeAttr("disabled"):e(".demo-filter .btn").attr("disabled","disabled")}),e(".blocks-wrapper .demo-filter .filter2").on("change",function(t){o!=e(".blocks-wrapper .demo-filter .filter1").val()||a!=e(this).val()?e(".demo-filter .btn").removeAttr("disabled"):e(".demo-filter .btn").attr("disabled","disabled")}),e(".blocks-wrapper .demo-filter .btn").on("click",function(t,l){t.preventDefault();var i=e(this),r=[];if(void 0===l&&(l=1),o=i.closest(".demo-filter").find(".filter1").val(),a=i.closest(".demo-filter").find(".filter2").val(),i.closest(".demo-filter").find(".filter2").val())r[0]=i.closest(".demo-filter").find(".filter2").val();else{var s=i.closest(".demo-filter").find(".filter1").val();i.closest(".demo-filter").find('.filter2 option[data-filter*="'+s+'"]').each(function(){r.push(e(this).val())})}e(".blocks-wrapper .category-list li:first-child a").trigger("click",[l,r]),i.attr("disabled","disabled")})}e("#molla-elementor-panel-molla-studio").on("click",function(t){if(t.preventDefault(),e(this).hasClass("disabled"))return!1;e(this).addClass("disabled"),e(".blocks-wrapper img[data-original]").each(function(){e(this).attr("src",e(this).data("original")),e(this).removeAttr("data-original")}),e(".blocks-wrapper").waitForImages(function(){e("#molla-studio-editor-button, #molla-elementor-panel-molla-studio").removeClass("disabled"),e.magnificPopup.open({items:{src:".blocks-wrapper"},type:"inline",mainClass:"blocks-cont mfp-fade",removalDelay:160,preloader:!1,callbacks:{change:function(){setTimeout(function(){e(".blocks-wrapper .blocks-list").hasClass("initialized")||(e(".blocks-wrapper .blocks-list").addClass("initialized").isotope({itemSelector:".block",layoutMode:"masonry"}),e(".mfp-wrap.blocks-cont").on("scroll",function(){var t=e(this);t.find(".blocks-wrapper").offset().top-t.offset().top+t.find(".blocks-wrapper").height()-t.height()<=10&&!t.find(".blocks-wrapper").hasClass("loading")&&parseInt(t.find(".blocks-wrapper .category-list a.active").data("total-page"),10)>=l+1&&(parseInt(t.find(".blocks-wrapper .category-list a.active").data("filter-by"),10)?t.find(".blocks-wrapper .category-list a.active").trigger("click",[l+1]):t.find(".blocks-wrapper .demo-filter .btn").trigger("click",[l+1]),t.find(".blocks-wrapper").addClass("infiniteloading"))}),e(".mfp-wrap.blocks-cont").trigger("scroll")),e(".blocks-wrapper .blocks-list").isotope("layout")},100)}}})})})})});